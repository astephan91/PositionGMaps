setwd("/Users/astephan/Desktop/PositionGMaps")
options(stringsAsFactors = T)
library(jsonlite)
library(ggplot2)
library(ggmap)
system.time(x <- fromJSON("positions.json"))
loc = x$locations
loc$time = as.POSIXct(as.numeric(x$locations$timestampMs)/1000, origin = "1970-01-01")
loc$lat = loc$latitudeE7 / 1e7
loc$lon = loc$longitudeE7 / 1e7
loc <- head(loc[rev(order(loc$time)),],10000)
head(loc)
geneve <- get_map(location = 'Geneva', zoom = 12)
lausanne <- get_map(location = 'Lausanne', zoom = 12)
geneve <- get_map(location = 'Geneva', zoom = 12, color = "bw")
ggmap(geneve) +
stat_summary_2d(geom = "tile", bins = 100, data = loc, aes(x = lon, y = lat, z = accuracy), alpha = 0.5) +
scale_fill_gradient(low = "blue", high = "red", guide = guide_legend(title = "Précision")) +
labs(
x = "Longitude",
y = "Latitude",
title = "Historique des positions autour de Genève")
geneve <- get_map(location = 'Geneva', zoom = 12, maptype = "roadmap", color = "bw")
ggmap(geneve) +
stat_summary_2d(geom = "tile", bins = 100, data = loc, aes(x = lon, y = lat, z = accuracy), alpha = 0.5) +
scale_fill_gradient(low = "blue", high = "red", guide = guide_legend(title = "Précision")) +
labs(
x = "Longitude",
y = "Latitude",
title = "Historique des positions autour de Genève")
lausanne <- get_map(location = 'Lausanne', zoom = 12, color = "bw")
ggmap(lausanne) +
stat_summary_2d(geom = "tile", bins = 100, data = loc, aes(x = lon, y = lat, z = accuracy), alpha = 0.5) +
scale_fill_gradient(low = "blue", high = "red", guide = guide_legend(title = "Précision")) +
labs(
x = "Longitude",
y = "Latitude",
title = "Historique des positions autour de Lausanne")
geneve <- get_map(location = 'Geneva', source = 'osm', zoom = 12, color = "bw")
lausanne <- get_map(location = 'Lausanne',source = 'osm', zoom = 12, color = "bw")
ggmap(geneve) +
stat_summary_2d(geom = "tile", bins = 100, data = loc, aes(x = lon, y = lat, z = accuracy), alpha = 0.5) +
scale_fill_gradient(low = "blue", high = "red", guide = guide_legend(title = "Précision")) +
labs(
x = "Longitude",
y = "Latitude",
title = "Historique des positions autour de Genève")
ggmap(geneve) +
stat_summary_2d(geom = "tile", bins = 100, data = loc, aes(x = lon, y = lat, z = accuracy), alpha = 0.5) +
scale_fill_gradient(low = "blue", high = "red", guide = guide_legend(title = "Précision")) +
labs(
x = "Longitude",
y = "Latitude",
title = "Historique des positions autour de Genève")
library(ggplot2)
library(ggmap)
ggmap(geneve) +
stat_summary_2d(geom = "tile", bins = 100, data = loc, aes(x = lon, y = lat, z = accuracy), alpha = 0.5) +
scale_fill_gradient(low = "blue", high = "red", guide = guide_legend(title = "Précision")) +
labs(
x = "Longitude",
y = "Latitude",
title = "Historique des positions autour de Genève")
ggmap(lausanne) +
stat_summary_2d(geom = "tile", bins = 100, data = loc, aes(x = lon, y = lat, z = accuracy), alpha = 0.5) +
scale_fill_gradient(low = "blue", high = "red", guide = guide_legend(title = "Précision")) +
labs(
x = "Longitude",
y = "Latitude",
title = "Historique des positions autour de Lausanne")
